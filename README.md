# EthereumVoting


Ссылка на статью о разрабатываемой программе
https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8229461/


Ссылка на документ для задач
https://docs.google.com/document/d/1TSwMQvPOnMTs8jAozxM94KEvyb64eRkfbpN_Xx1uUXg/edit

## Remix IDE
Максимально просто и быстро смоделировать локальную сеть Ethereum можно с помощью IDE Remix. Она доступна в качестве веб интерфейса на странице https://remix.ethereum.org/ или в качестве desktop версии, которую можно загрузить по ссылке https://github.com/ethereum/remix-desktop/releases выбрав удобную версию.
Для разворачивания смарт-контракта в Remix IDE нужно:
Открыть IDE после установки зайти в папку Contracts, в ней создать файл с расширением .sol, это и есть файл с кодом смарт-контракта. В качестве примера кода использовать файл https://github.com/mirabdulHaseeb/brownie_election/blob/master/contracts/Election.sol. После сохранения файла выбрать его, в меню слева переключиться на вкладку Solidity Compiler, скомпилировать контракт, перейти на вкладку Run&Deploy Contracts, ввести название контракта (можно такое же как у файла) и нажать deploy (оранжевая кнопка).
После этого во вкладке Deployed Contracts с контрактом можно взаимодействовать с помощью кнопок, соответствующих реализованным методам (), в поле ACCOUNT можно переключаться между адресами Ethereum и вызывать методы от их имени имитируя действия пользователей. В окне снизу выводятся все записанные транзакции. Поле Value предназначено для указания значения Эфира, который пользователь хочет отправить на другой адрес. 

## Truffle
Чтобы установить Truffle на Ubuntu: (https://ubunlog.com/en/nodejs-npm-installation-ubuntu-20-04-18-04/)

Подробнее о командах взаимодействия с контрактом из командной строки develop можно узнать на странице https://trufflesuite.com/docs/truffle/how-to/debug-test/use-truffle-develop-and-the-console/


## Актуальная организация среды разработки
Предусловия:
ОС Windows
Установлены Node.js, npm (установочный пакет скачивается с официального сайта, ставятся вместе)
Установлены Remix IDE, Truffle (устанавливается командой `npm install truffle -g`),
Ganache (скачивается с сайта Truffle), расширение браузера Metamask.

В Remix IDE создается смарт-контракт, в Ganache создается тестовая сеть,
контракт компилируется в Remix IDE и деплоится в тестовую сеть с помощью Ganache Provider.
(контракт также может быть скомпилирован из Truffle для подробного отображения в Ganache https://trufflesuite.com/docs/truffle/how-to/compile-contracts/)
В директории `Truffle\Voting` необходимо выполнить команду `npm install express --save`, она установит веб-сервер express для js.
В этой же диретории лежит скрипт на js, возвращающий стартовую страницу приложения голосования и сама домашняя страница сайта.
В коде домашней страницы необходимо явно указать адрес смарт-контракта и ABI, которые можно взять в Remix IDE после деплоя контракта в сеть.

## Схема работы программы
Из директории `Truffle\Voting` выполняется команда `node server.js`, которая запускает скрипт, слушающий порт 5000.
После обращения к заданному порту из браузера, скрипт возвращает стартовую страницу голосования, в коде которой явно прописаны
адрес смарт-контракта и ABI (интерфейс взаимодействия смарт-контракта с  внешними интеграциями).
Дальнейшее взаимодействие пользователя и сети проиходит без участия сервера напрямую с тестовой сетью.
Для получения данных из контракта необходимо сначала подключить Metamask и подключиться к контракту.
